(this["webpackJsonpfreboard-ts"]=this["webpackJsonpfreboard-ts"]||[]).push([[0],{13:function(t,e){(function(){var e,n,a=[].slice;n=new(e=function(){var t;return t={},{sub:function(e,n){var a,r,o,s,i;for(a=e.split(" "),t,i=[],o=0,s=a.length;o<s;o++)r=a[o],t[r]||(t[r]=[]),i.push(t[r].push(n));return i},pub:function(){var e,n,r,o,s;if(n=(e=1<=arguments.length?a.call(arguments,0):[]).shift(),t[n]){for(r=0,o=(s=t[n]).length;r<o&&!1!==s[r].apply(null,e);r++);return!0}},unsub:function(e,n){var a,r,o,s,i,c,u;for(u=[],i=0,c=(a=e.split(" ")).length;i<c;i++)s=a[i],(o=t[s])&&(n?u.push(function(){var e,a,i;for(i=[],r=e=0,a=o.length;e<a;r=++e)if(o[r]===n){(o=o.slice()).splice(r,1),t[s]=o;break}return i}()):delete t[s]);return u},callbacks_map:function(){return t}}}),t.exports={emitter:n,Emitter:e}}).call(this)},29:function(t,e,n){t.exports=n(56)},34:function(t,e,n){},35:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){},56:function(t,e,n){"use strict";n.r(e);var a,r,o,s,i,c,u,l,f,p,d,h,m,g,v,y,b,S=n(0),N=n.n(S),_=n(17),E=n.n(_),j=(n(34),n(35),n(36),n(37),n(6)),w=n(5),O=n(11),x=n(12),D=n(2),k=(a=Array.from(b=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]),(r=Object(D.a)(a,12))[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],b),M=(o=Array.from(b=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"]),l=(s=Object(D.a)(o,12))[0],f=s[1],p=s[2],d=s[3],h=s[4],m=s[5],g=s[6],v=s[7],y=s[8],i=s[9],c=s[10],u=s[11],b),A={Standard:{name:"Standard E",notes:[h,u,v,p,i,h],offset:[0,0,0,0,0,0]},DropD:{name:"Dropped D",notes:[h,u,v,p,i,p],offset:[0,0,0,0,0,-2]},"1StepDown":{name:"1 step down",notes:[d,c,g,f,y,d],offset:[-1,-1,-1,-1,-1,-1]},DropC:{name:"Dropped C",notes:[p,i,m,l,v,l],offset:[-2,-2,-2,-2,-2,-4]}},C=function(t,e){for(var n=0;n<e.length;n++){if(t===e[n])return n}return-1},P=function(t,e){return t===e.length-1?0:t+1},X=function(t,e,n,a){return[[]].concat(function(){for(var r=[],o=function(t,o,s){var i=function(t,e){var n=C(t,e);return function(){var t=n;return n=P(n,e),e[t]}}(n[t],a);r.push(function(t,e,n){for(var a=[],r=t<e,o=n?r?e+1:e-1:e,s=t;r?s<o:s>o;r?s++:s--)a.push(s);return a}(0,e,!0).map((function(){return i()})))},s=0,i=t-1,c=0<=i;c?s<=i:s>=i;c?s++:s--)o(s);return r}())};var F=n(7),R=function(t,e,n){var a,r=[{name:e,degree:1,scaleName:"Root"}];a=C(e,t);var o=0;return r.concat(function(){for(var e=[],r=0,s=Array.from(n.size);r<s.length;r++){var i=s[r];3===i?(a=P(a,t),a=P(a,t),a=P(a,t)):2===i?(a=P(a,t),a=P(a,t)):a=P(a,t),e.push({name:t[a],degree:o+2,scaleName:n.names[o]}),o++}return e}())},G=function(t,e){var n=R(k,t,e),a=R(M,t,e);return console.log({Note:t}),t.includes("b")?{scale:a,notes:M}:t.includes("#")||function(t){return F.uniq(t.map((function(t){return t.name[0]}))).length===t.length}(n)?{scale:n,notes:k}:{scale:a,notes:M}},T={Major:{desc:"Major scale",size:[2,2,1,2,2,2,1],names:["major 2nd","major 3rd","perfect 4th","perfect 5th","major 6th","major 7th","octave"],get_notes:function(t){return G(t,T.Major)}},Minor:{desc:"Minor scale",names:["major 2nd","minor 3rd","perfect 4th","perfect 5th","minor 6th","minor 7th","octave"],size:[2,1,2,2,1,2,2],get_notes:function(t){return G(t,T.Minor)}},Arabic:{desc:"Arabic scale",names:[],size:[1,3,1,1,3,1,2],get_notes:function(t){return G(t,T.Arabic)}},Blues:{desc:"Blues scale",names:[],size:[3,2,1,1,3,2],get_notes:function(t){return G(t,T.Blues)}},PentatonicMinor:{desc:"Pentatonic Minor",names:["minor 3rd","perfect 4th","perfect 5th","minor 7th","octave"],size:[3,2,2,3,2],get_notes:function(t){return G(t,T.PentatonicMinor)}},PentatonicMajor:{desc:"Pentatonic Major",names:["major 3rd","perfect 4th","perfect 5th","major 7th","octave"],size:[2,2,3,2,3],get_notes:function(t){return G(t,T.PentatonicMajor)}}},W=n(15),L=n(23),z=n(13),B=n(25),U=n.n(B),H={1:{},2:{},3:{},4:{},5:{},6:{}},I=function(t,e,n){return H[t][e]?"function"===typeof n?n():void 0:a=V(t,e,(function(){return H[t][e]=a,"function"===typeof n?n():void 0}));var a},V=function(t,e,n){var a="./resources/".concat(t,"string/wav/").concat(e,".wav"),r="./resources/".concat(t,"string/ogg/").concat(e,".ogg"),o="./resources/".concat(t,"string/mp3/").concat(e,".mp3");return new U.a.Howl({src:[r,o,a],onload:n})},q=function(t){Object(x.a)(n,t);var e=Object(O.a)(n);function n(t){var a;return Object(j.a)(this,n),(a=e.call(this,t)).state={},a.elRef=void 0,a.turnOnLoader=function(){return a.setState({loader:!0})},a.turnOffLoader=function(){return a.setState({loader:!1})},a.onMouseDown=function(t){var e;if(0===t.button){var n=(null===(e=a.elRef.current)||void 0===e?void 0:e.offsetLeft)||0,r=t.pageX-n;return a.setState({dragging:!0,relx:r}),console.log({left:n,relx:r,dragging:!0}),t.stopPropagation(),t.preventDefault()}},a.onMouseUp=function(t){return a.setState({dragging:!1}),t.stopPropagation(),t.preventDefault()},a.onMouseMove=function(t){if(a.state.dragging){var e={},n=t.pageX-a.state.relx,r=a.props,o=r.minX,s=r.maxX,i=r.useX;return n>=o&&n<=s?e.x=n:n<=o?e.x=o:n>=s&&(e.x=s),console.log({pos:e,newX:n,minX:o,maxX:s,useX:i,ch:a.props.onXChange}),"function"===typeof a.props.onXChange&&a.props.onXChange(e.x),a.setState({pos:e}),t.stopPropagation(),t.preventDefault()}console.log("not draggin")},a.elRef=N.a.createRef(),a.state={pos:t.initialPos||{x:0,y:0},dragging:!1,relx:0,loader:!!t.loader,loaderFontSize:20},a}return Object(w.a)(n,[{key:"componentDidMount",value:function(){return z.emitter.sub("EVENT_SOUNDS_LOADING_START",this.turnOnLoader),z.emitter.sub("EVENT_SOUNDS_LOADING_STOP",this.turnOffLoader)}}]),Object(w.a)(n,[{key:"render",value:function(){return N.a.createElement("div",{ref:this.elRef,className:"col-md-4 selector",style:{height:this.props.height,width:this.props.width,left:"".concat(this.state.pos.x,"px"),top:"".concat(this.state.pos.y,"px"),position:"absolute"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},N.a.createElement("div",{style:{width:"100%",height:"100%",background:"black",textAlign:"center",position:"relative",opacity:.5,paddingTop:"".concat(this.props.height/2-this.state.loaderFontSize,"px"),display:this.state.loader?"block":"none"}},N.a.createElement("span",{style:{opacity:1,color:"white",fontSize:"".concat(this.state.loaderFontSize,"px"),fontStyle:"italic"}},"loading")))}},{key:"componentDidUpdate",value:function(t,e){return this.state.dragging&&!e.dragging?(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)):this.state.dragging&&e.dragging?void 0:(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))}}]),n}(N.a.Component),J=function(t,e,n,a,r,o,s,i){return a||(a=!1),r||(r=!1),o||(o=!1),s||(s=!1),i||(i=!1),{data:function(){return{sNum:t,fNum:e,note:n,checked:a,playing:r,selected:o,root_note:s,is_open:i}},playStart:function(){return r=!0},playStop:function(){return r=!1},check:function(){return a=!0},uncheck:function(){return a=!1},select:function(){return o=!0},unselect:function(){return o=!1},set_root:function(){return s=!0},set_open:function(){return i=!0}}},$=function(t){var e="",n="fret",a=t.data.checked?"on shadow":"off";t.data.checked&&t.data.selected&&(a="on-selected shadow"),t.data.root_note&&(a="on-selected-root shadow"),t.data.checked&&(e=t.data.note);var r=t.data.playing?"playing":"";return t.data.is_open&&(t.data.checked||(a="".concat(a," open shadow")),e=t.data.note,n=""),N.a.createElement("div",{className:"col-md-1 ".concat(n," padding0"),style:{width:t.width,height:t.height}},N.a.createElement("span",{className:"string"}),N.a.createElement("span",{className:"circleBase ".concat(a," ").concat(r)},e))},K=function(t){var e,n=function(e){return N.a.createElement($,{key:"fret_".concat(e.data().sNum).concat(e.data().fNum),data:e.data(),width:t.Fwidth,height:t.Fheight})},a=[function(){var a=[];for(var r in t.data.frets)e=t.data.frets[r],a.push(n(e));return a}()];return N.a.createElement("div",{className:"row"},a)},Q=n(28),Y=n(18),Z=n(21),tt=new AudioContext;var et=function(t){Object(x.a)(n,t);var e=Object(O.a)(n);function n(t){var a;Object(j.a)(this,n),(a=e.call(this,t)).jsGuitarRef=void 0,a.displayRef=void 0,a.playScaleHelper=function(){var t=T[a.props.Scale].get_notes(a.props.Note),e=t.scale,n=t.notes,r=X(a.state.stringsNum,a.state.fretsNum,a.props.tuning.notes,n),o=Object(W.a)(a),s=function(t,n){var s=Object(D.a)(t,2),i=s[0],c=s[1],u=r[i][c],l=F.find(e,(function(t){return t.name===u}));a.displayRef.current.innerHTML="".concat(l.name," - ").concat(l.scaleName),o.state.is_playing?(console.log("doing the thing at ",{sNum:i,fNum:c}),o.startPlayFret([i,c]),function(){var t=tt.currentTime,e=tt.createOscillator();e.connect(tt.destination),e.frequency.value=880,e.start(t),e.stop(t+.05)}(),setTimeout(n,6e4/a.props.bpm)):(console.log("not playing anymore so canceling"),o.setState({playing_fret:void 0}),n("stop"))},i=a.get_selected_frets();return z.emitter.pub("EVENT_SOUNDS_LOADING_START"),L.a.map(i,(function(){var t=Array.from(arguments.length<=0?void 0:arguments[0]),e=Object(D.a)(t,2),n=e[0],a=e[1],r=arguments.length<=1?void 0:arguments[1],s=o.props.tuning.offset[n-1];return console.log("loading fret!",{sNum:n,fNum:a}),I(n,parseInt(a)+s,r)}),(function(){return console.log("done!"),z.emitter.pub("EVENT_SOUNDS_LOADING_STOP"),L.a.mapSeries(i,s,(function(t){if(o.state.is_playing)return o.state.changeDirection&&o.toggleDirection(),o.state.repeat?o.playScale():o.setState({is_playing:!1})}))}))},a.get_frets=function(){var t=T[a.props.Scale].get_notes(a.props.Note),e=t.scale,n=t.notes,r=X(a.state.stringsNum,a.state.fretsNum,a.props.tuning.notes,n),o=function(t,e,n){for(var a={},r=1,o=t,s=1<=o;s?r<=o:r>=o;s?r++:r--){a[r]={};for(var i=0,c=e,u=0<=c;u?i<=c:i>=c;u?i++:i--)a[r][i]=J(r,i,n[r][i],!1,!1)}return a}(a.state.stringsNum,a.state.fretsNum,r),s=a.state.selectorFretsCount*a.props.fretWidth;if(!a.state.selector.initialPos)return o;var i=a.state.selectorX;return F.each(o,(function(t,n){for(var r in t){var o,c,u,l=t[r],f=((null===(o=a.state.selector)||void 0===o||null===(c=o.initialPos)||void 0===c?void 0:c.x)||0)+r*a.props.fretWidth;if(f>=i&&f<i+s&&l.select(),l.data().note===a.props.Note&&l.set_root(),a.state.playing_fret&&a.state.is_playing){var p=Array.from(a.state.playing_fret),d=Object(D.a)(p,2),h=d[0],m=d[1];h===n&&m===r&&l.playStart()}u=l.data().note,Array.from(e.map((function(t){return t.name}))).includes(u)&&l.check(),"0"===r&&l.set_open()}})),o},a.displayRef=N.a.createRef();var r,o=(null!=t.data?t.data.stringsNum:void 0)||6,s=(null!=t.data?t.data.fretsNum:void 0)||16,i=t.selectorFretsCount||4,c=i*t.fretWidth;return a.jsGuitarRef=N.a.createRef(),r={height:o*t.fretHeight,width:c,onXChange:function(t){return a.onSelectorMove(t)},minX:-1,maxX:-1},a.state={stringsNum:o,fretsNum:s,timeout:400,selector:r,is_playing:!1,selectorFretsCount:i,direction:"DOWN",repeat:!1,changeDirection:!1,playing_fret:void 0,selectorX:0},a}return Object(w.a)(n,[{key:"startPlayFret",value:function(t){return this.setState({playing_fret:t})}},{key:"playScale",value:function(){var t=this;console.log("setting playing to true"),this.setState({is_playing:!0},(function(){t.playScaleHelper()}))}},{key:"stopPlayScale",value:function(){return this.setState({is_playing:!1})}},{key:"toggleDirection",value:function(){return"UP"===this.state.direction?this.setState({direction:"DOWN"}):this.setState({direction:"UP"})}},{key:"get_selected_frets",value:function(){var t,e,n,a=this,r=[],o=function(){var t=[],e=a.get_frets();return F.each(e,(function(e,n){t.push([e,n])})),t}();"DOWN"===this.state.direction&&(o=o.reverse());for(var s=function(){var o=Object(D.a)(c[i],2);e=o[0],t=o[1];var s=void 0,u=[];F.each(e,(function(t,e){u.push([t,e])})),"UP"===a.state.direction&&(u=u.reverse());for(var l=0,f=Array.from(u);l<f.length;l++){var p=Object(D.a)(f[l],2);n=p[0],s=p[1],n.data().selected&&n.data().checked&&r.push([t,s])}},i=0,c=Array.from(o);i<c.length;i++)s();return r}},{key:"componentDidMount",value:function(){if(this.jsGuitarRef.current){var t=this.state.selectorFretsCount*this.props.fretWidth,e=this.state.selector,n=this.jsGuitarRef.current.offsetLeft;return e.initialPos={x:n,y:this.jsGuitarRef.current.offsetTop},e.minX=n,e.maxX=n+(this.state.fretsNum+1)*this.props.fretWidth-t,this.setState({selector:e,selectorX:n})}}}]),Object(w.a)(n,[{key:"onSelectorMove",value:function(t){return this.setState({selectorX:t,is_playing:!1})}},{key:"render",value:function(){var t=this,e=this.get_frets(),n=nt(0,this.state.stringsNum,!0).map((function(n){return N.a.createElement(K,{key:"string_item_".concat(n),data:{frets:e[n]},Fwidth:t.props.fretWidth,Fheight:t.props.fretHeight})})),a=t.state.selector.initialPos?t.state.selector?N.a.createElement(q,t.state.selector):void 0:N.a.createElement("div",null);nt(0,this.state.fretsNum,!0).map((function(e){var n="",a=t.state.selectorX;if(a){var r,o=t.state.selectorFretsCount*t.props.fretWidth,s=((null===(r=t.state.selector.initialPos)||void 0===r?void 0:r.x)||0)+e*t.props.fretWidth;s>=a&&s<a+o&&(n="active-num")}return N.a.createElement("div",{key:"fret_num_".concat(e),className:"col-md-1 fretnum ".concat(n),style:{width:"".concat(t.props.fretWidth,"px")}},e)}));return N.a.createElement("div",{style:{width:(this.state.fretsNum+1)*this.props.fretWidth,margin:"auto"}},N.a.createElement("div",{className:"js-guitar",ref:this.jsGuitarRef},a,n),N.a.createElement("div",null,N.a.createElement(Q.a,{variant:"outline-primary",onClick:function(){return t.state.is_playing?t.stopPlayScale():t.playScale()}},this.state.is_playing?N.a.createElement(Y.a,{icon:Z.b}):N.a.createElement(Y.a,{icon:Z.a}))),N.a.createElement("h1",{ref:this.displayRef,style:{display:this.state.is_playing?"block":"none"}}))}}]),n}(N.a.Component);function nt(t,e,n){for(var a=[],r=t<e,o=n?r?e+1:e-1:e,s=t;r?s<o:s>o;r?s++:s--)a.push(s);return a}var at,rt=n(22),ot=n.n(rt),st=["C","C#","Db","D","D#","Eb","E","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","Cb"].map((function(t){return{value:t,label:t}})),it=function(){var t=[];for(var e in T)t.push({value:e,label:e});return t}(),ct=(function(){var t=[];for(at in A){var e=A[at];t.push({value:at,label:e.name})}}(),function(t){Object(x.a)(n,t);var e=Object(O.a)(n);function n(){var t;Object(j.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).state={Note:"C",Scale:"Major",tuning:"Standard",bpm:80},t}return Object(w.a)(n,[{key:"render",value:function(){var t,e=this,n=A[this.state.tuning].name;return N.a.createElement("div",null,N.a.createElement("div",null,N.a.createElement("h2",{className:"text-center"},"".concat(this.state.Note," ").concat(this.state.Scale," (").concat(n," tuning)")),N.a.createElement("p",{className:"text-center text-muted text-bold"},(t=T[this.state.Scale].size,function(){for(var e=[],n=0,a=Array.from(t);n<a.length;n++){var r=a[n];2===r?e.push("Step"):1===r?e.push("hStep"):3===r?e.push("BigSTEP"):e.push(void 0)}return e}().join(" - "))),N.a.createElement("p",{className:"text-center text-bold"},"".concat(T[this.state.Scale].get_notes(this.state.Note).scale.map((function(t){return t.name})).join(" "))),N.a.createElement("div",null,N.a.createElement("div",{style:{width:"850px",margin:"auto"}},N.a.createElement("div",{style:{display:"flex",flexDirection:"row",zIndex:1e4,paddingBottom:"20px"}},N.a.createElement("div",{style:{width:"100px"}},N.a.createElement(ot.a,{options:st,placeholder:"note",searchable:!1,values:[{value:this.state.Note,label:this.state.Note}],onChange:function(t){return e.setState({Note:t[0].value})}})),N.a.createElement("div",{style:{width:"250px"}},N.a.createElement(ot.a,{options:it,placeholder:"scale",searchable:!1,values:[{value:this.state.Scale,label:this.state.Scale}],onChange:function(t){console.log(t),e.setState({Scale:t[0].value})}})),N.a.createElement("input",{value:this.state.bpm,onChange:function(t){return e.setState({bpm:Number(t.target.value)})}}))),N.a.createElement(et,{bpm:this.state.bpm,fretWidth:50,fretHeight:30,selectorFretsCount:4,Note:this.state.Note,Scale:this.state.Scale,tuning:A[this.state.tuning]}))))}}]),n}(N.a.Component));var ut=function(){return N.a.createElement(ct,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));E.a.render(N.a.createElement(ut,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.26bbfe8f.chunk.js.map